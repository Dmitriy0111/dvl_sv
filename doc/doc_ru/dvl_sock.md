# dvv_sock (socket class)

Данный файл содержит описание канала обмена между верификационными компонентами с возможностью блокировки. Данные для обмена могут быть как системные, так и пользовательские.

Заголовок:
```Verilog
class dvv_sock #(type mail_t = int);
```

## Параметры класса:

| Поле      | Описание                              |
| --------- | ------------------------------------- |
| mail_t    | Тип переменной для обмена по каналу   |

## Поля и функции/задачи класса  

### Поля:
| Имя       | Тип                   | Описание                              |
| --------- | --------------------- | ------------------------------------- |
| type_name | const static string   | Тип компонента                        |
| sock_e    | event                 | Событие по приёму или передачи данных |
| sock_m    | mailbox #(mail_t)     | Канал обмена для передачи данных      |

#### Значение некоторых полей:

| Поле      | Значение      |
| --------- | ------------- |
| type_name | "dvv_sock"    |

### Функции/Задачи:
| Имя       | Описание                                          |
| --------- | ------------------------------------------------- |
| new       | Конструктор класса                                |
| connect   | Задача для соединения сокетов разных классов      |
| trig_sock | Задача для выставления события                    |
| wait_sock | Задача для ожидания события                       |
| put_msg   | Задача для помещения сообщения в канал обмена     |
| get_msg   | Задача для извлечения сообщения из канала обмена  |
| send_msg  | Задача для отправки сообщения                     |
| rec_msg   | Задача для приёма сообщения                       |

### Описание функций/задач:

#### new
Конструктор класса для создания экземпляра dvv_sock.

Заголовок:
```Verilog
function new();
```

#### connect
Задача для соединения сокетов разных классов.

Заголовок:
```Verilog
extern task connect(dvv_sock #(mail_t) oth_sock);
```

Аргументы:
| Имя       | Тип                   | Описание                      |
| --------- | --------------------- | ----------------------------- |
| oth_sock  | dvv_sock #(mail_t)    | Экземпляр другого dvv_sock    |

#### trig_sock
Задача для выставления события sock_e.

Заголовок:
```Verilog
task trig_sock();
```

#### wait_sock
Задача для ожидания события sock_e.

Заголовок:
```Verilog
task wait_sock();
```

#### put_msg
Задача для помещения сообщения в канал обмена sock_m.

Заголовок:
```Verilog
task put_msg(mail_t msg);
```

Аргументы:
| Имя   | Тип       | Описание                  |
| ----- | --------- | ------------------------- |
| msg   | mail_t    | Отправляемое сообщение    |

#### get_msg
Задача для извлечения сообщения из канала обмена sock_m.

Заголовок:
```Verilog
task get_msg(ref mail_t msg);
```

Аргументы:
| Имя   | Тип           | Описание                  |
| ----- | ------------- | ------------------------- |
| msg   | ref mail_t    | Принимаемое сообщение     |

#### send_msg
Задача для отправки сообщения при помощи sock_m и sock_e.

Заголовок:
```Verilog
task send_msg(mail_t msg);
```

Аргументы:
| Имя   | Тип           | Описание                  |
| ----- | ------------- | ------------------------- |
| msg   | ref mail_t    | Отправляемое сообщение    |

#### rec_msg
Задача для приёма сообщения при помощи sock_m и sock_e.

Заголовок:
```Verilog
task rec_msg(ref mail_t msg);
```

Аргументы:
| Имя   | Тип           | Описание                  |
| ----- | ------------- | ------------------------- |
| msg   | ref mail_t    | Принимаемое сообщение     |

## Использование класса

При объявления экземпляра класса необходимо указать тип переменной подлежащей обмену и имя:
```Verilog
    // Объявление экземпляра класса с системным типом переменной
    dvv_sock    #(int)      item_sock_0;
    // Объявление экземпляра класса с пользовательским типом переменой
    dvv_sock    #(user_t)   item_sock_1;
```

Создание экземпляра класса производится вызовом конструктора:
```verilog
    item_sock_0 = new();
    item_sock_1 = new();
```

Для подключения одного экземпляра класса к другому экземпляру необходимо вызвать функцию connect, при этом типы переменных для обмена должны совпадать. Один канал обмена может быть подключен только один раз.
```verilog
    item_sock_in.connect(item_sock_out);
```

Для отправки сообщения следует использовать функцию send_msg.
```verilog
    int send_data;
    send_data = 8'h55;
    item_sock_0.send_msg(send_data);
```

Для принятия сообщения следует использовать функцию rec_msg.
```verilog
    int rec_data;
    item_sock_0.rec_msg(rec_data);
```